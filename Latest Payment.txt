	General; The update happening in the company_balance_account should be monitored during editing such that no doubling should happen and any edit in the amount should also reflect respectively.

1.Payment
1.a)Entity Customer or Partner:
1.a.1)Add
	1.a.1.1)If payment type is "cash withdrawal"; then check if that customer/partner have balance in wallet, only if they have balance or credit limit(only for customer), then approve this transaction(for partners check whether negative balance is flagged for wallet) , else show not sufficient fund. If customer/partner wallet have enough fund, then on confirmation of the transaction, deduct that amount from respective wallet or from credit limit(for customers only). If deductible amount is greater than wallet amount and the balance amount is within credit limit, then deduct amount from wallet first, then deduct the remaining from credit limit(for customers only). According to the mode of payment(online or cash), deduct that amount from that company account. 
	1.a.1.2)If payment type is "Other Expense"; "deduct from wallet/credit" toggle will decide whether to deduct from wallet or not. If toggle is turned on, that amount will deducted from respective wallet. The company account will be updated according to the mode of payment. rest updation of wallet logic(if toggle on) is same as that of cash withdrawal
1.a.2)Edit
	1.a.2.1)If payment type is "cash withdrawal"; same logic as of adding , but changing entity should reflect respective update in new entity and at same time, reverse the wallet updation happened to old entity. 
	1.a.2.2)If payment type is "Other Expense"; editing the toggle(turn off or on) should update wallet accoridngly . if previously it was turned off(wallet was not changed), then turning on should update wallet and if previously it was turned on(wallet was changed) then turning off toggle should revise wallet to old one.  In addition to this always remember, if entity is changed, the updation caused to old entity should also be reversed. I think keeping a track on this toggle is needed to reverse the updations in case of changes.

1.a.3)Delete
	Editing of transactions already expected to reverse old entries. So make sure delete only affect the latest entry and reverse all the updates happened in the last edit. So everything will be back to initial state.


1.b) Entity Agent:

1.b.1)Add
	1.b.1.1)If payment type is cash deposit; check whether the agent have credit to be paid, then update the amount in credit limit first, then if there is balance to be updated, then increase that amount to the wallet of agent.According to the mode of payment(online or cash), deduct that amount from that company account.
	1.a.1.2)If payment type is "Other Expense"; "credit to wallet/credit" toggle will decide whether to credit to wallet or not. If toggle is turned on, that amount will credited to respective wallet. The company account will be updated according to the mode of payment. rest updation of wallet logic(if toggle on) is same as that of cash deposit
2.a.2)Edit
	1.a.2.1)If payment type is "cash deposit"; same logic as of adding , but changing entity should reflect respective update in new entity and at same time, reverse the wallet updation happened to old entity. 
	1.a.2.2)If payment type is "Other Expense"; editing the toggle(turn off or on) should update wallet accoridngly . if previously it was turned off(wallet was not changed), then turning on should update wallet and if previously it was turned on(wallet was changed) then turning off toggle should revise wallet to old one.  In addition to this always remember, if entity is changed, the updation caused to old entity should also be reversed. I think keeping a track on this toggle is needed to reverse the updations in case of changes.

2.a.3)Delete
	Editing of transactions already expected to reverse old entries. So make sure delete only affect the latest entry and reverse all the updates happened in the last edit. So everything will be back to initial state.


2.Receipt
2.a)Entity Customer or Partner:
2.a.1)Add
	2.a.1.1)If payment mode if "cash deposit"; for customer check whether the customer have credit usage, then update that first, for the balance amount update the wallet of that customer. For partner direct wallet balance update should be given.Then according to the mode of payment(online or cash), update corresponding amount to company balance. 
	2.a.1.2)If payment mode is "Other Receipt"; "credit to wallet/credit" toggle will decide whether to credit to wallet or not. If toggle is turned on, that amount will credited to respective wallet. The company account will be updated according to the mode of payment. rest updation of wallet logic(if toggle on) is same as that of cash deposit
2.a.2)Edit
	2.a.2.1)If payment type is cash deposit; same logic as of adding , but changing entity should reflect respective update in new entity and at same time, reverse the wallet updation happened to old entity. 
	2.a.2.2)If payment type is "Other Receipt"; editing the toggle(turn off or on) should update wallet accordingly . if previously it was turned off(wallet was not changed), then turning on should update wallet and if previously it was turned on(wallet was changed) then turning off toggle should revise wallet to old one.  In addition to this always remember, if entity is changed, the updation caused to old entity should also be reversed. I think keeping a track on this toggle is needed to reverse the updations in case of changes.

2.a.3)Delete
	Editing of transactions already expected to reverse old entries. So make sure delete only affect the latest entry and reverse all the updates happened in the last edit. So everything will be back to initial state.

2.b) Entity Agent:

2.b.1)Add
	2.b.1.1)Only payment type is Other Receipt"; "deduct from wallet/credit" toggle will decide whether to deduct from wallet or not. If toggle is turned on, that amount will deducted from respective wallet. The company account will be updated according to the mode of payment. 

2.b.2)Edit
	2.b.2.1)Editing the toggle(turn off or on) should update wallet accordingly. if previously it was turned off(wallet was not changed), then turning on should update wallet and if previously it was turned on(wallet was changed) then turning off toggle should revise wallet to old one.  In addition to this always remember, if entity is changed, the updation caused to old entity should also be reversed. I think keeping a track on this toggle is needed to reverse the updations in case of changes.

2.b.3)Delete
	Editing of transactions already expected to reverse old entries. So make sure delete only affect the latest entry and reverse all the updates happened in the last edit. So everything will be back to initial state.
	


	
